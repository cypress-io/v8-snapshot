<!DOCTYPE html><html class="default no-js"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>blueprint | v8-snapshot</title><meta name="description" content="Documentation for v8-snapshot"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem(&quot;tsd-theme&quot;) || &quot;os&quot;)</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">v8-snapshot</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">v8-snapshot</a></li><li><a href="blueprint.html">blueprint</a></li></ul><h1>Module blueprint</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section "><h3>Type aliases</h3><ul class="tsd-index-list"><li class="tsd-kind-type-alias tsd-parent-kind-module"><a href="blueprint.html#BlueprintConfig" class="tsd-kind-icon">Blueprint<wbr/>Config</a></li></ul></section><section class="tsd-index-section "><h3>Functions</h3><ul class="tsd-index-list"><li class="tsd-kind-function tsd-parent-kind-module"><a href="blueprint.html#scriptFromBlueprint" class="tsd-kind-icon">script<wbr/>From<wbr/>Blueprint</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Type aliases</h2><section class="tsd-panel tsd-member tsd-kind-type-alias tsd-parent-kind-module"><a id="BlueprintConfig" class="tsd-anchor"></a><h3>Blueprint<wbr/>Config</h3><div class="tsd-signature tsd-kind-icon">Blueprint<wbr/>Config<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-symbol">{ </span>auxiliaryData<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>basedir<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>customRequireDefinitions<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Buffer</span><span class="tsd-signature-symbol">; </span>includeStrictVerifiers<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">; </span>mainModuleRequirePath<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>nodeEnv<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>processNodeVersion<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>processPlatform<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">; </span>sourceMap<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Buffer</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">undefined</span><span class="tsd-signature-symbol">; </span>sourcemapEmbed<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">; </span>sourcemapExternalPath<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">undefined</span><span class="tsd-signature-symbol">; </span>sourcemapInline<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol"> }</span></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/cypress-io/v8-snapshot/blob/da2caba/src/blueprint.ts#L50">src/blueprint.ts:50</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Configures the generation of the snapshot script from the <em>Blueprint</em>
templates.</p>
</div><dl class="tsd-comment-tags"><dt>property</dt><dd><p>processPlatform value to return during snapshot creation for <code>process.platform</code></p>
</dd><dt>property</dt><dd><p>processNodeVersion value to return during snapshot creation for <code>process.version</code></p>
</dd><dt>property</dt><dd><p>mainModuleRequirePath relative path to the module we consider the
main entry point.
NOTE: the <a href="../classes/doctor_snapshot_doctor.SnapshotDoctor.html">SnapshotDoctor</a> changes this in order to verify multiple
modules using the same bundle.</p>
</dd><dt>property</dt><dd><p>auxiliaryData data to embed with the snapshot</p>
</dd><dt>property</dt><dd><p>customRequireDefinitions a hash of module initializer functions
that are bundled</p>
</dd><dt>property</dt><dd><p>includeStrictVerifiers see <a href="snapshot_generator.html#GenerationOpts">GenerationOpts</a> includeStrictVerifiers</p>
</dd><dt>property</dt><dd><p>nodeEnv see <a href="snapshot_generator.html#GenerationOpts">GenerationOpts</a> nodeEnv</p>
</dd><dt>property</dt><dd><p>basedir the base dir of the project for which we are creating the
snapshot</p>
</dd><dt>property</dt><dd><p>sourceMap {@link Buffer} with content of raw sourcemaps</p>
</dd><dt>property</dt><dd><p>sourcemapInline see <a href="snapshot_generator.html#GenerationOpts">GenerationOpts</a> sourcemapInline</p>
</dd><dt>property</dt><dd><p>sourcemapEmbedsee <a href="snapshot_generator.html#GenerationOpts">GenerationOpts</a> sourcemapEmbed</p>
</dd><dt>property</dt><dd><p>sourcemapExternalPath path relative to the snapshot script where
the sourcemaps are stored</p>
</dd></dl></div><div class="tsd-type-declaration"><h4>Type declaration</h4><ul class="tsd-parameters"><li class="tsd-parameter"><h5>auxiliary<wbr/>Data<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5>basedir<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5>custom<wbr/>Require<wbr/>Definitions<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Buffer</span></h5></li><li class="tsd-parameter"><h5>include<wbr/>Strict<wbr/>Verifiers<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">boolean</span></h5></li><li class="tsd-parameter"><h5>main<wbr/>Module<wbr/>Require<wbr/>Path<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5>node<wbr/>Env<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5>process<wbr/>Node<wbr/>Version<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5>process<wbr/>Platform<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span></h5></li><li class="tsd-parameter"><h5>source<wbr/>Map<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Buffer</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">undefined</span></h5></li><li class="tsd-parameter"><h5>sourcemap<wbr/>Embed<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">boolean</span></h5></li><li class="tsd-parameter"><h5>sourcemap<wbr/>External<wbr/>Path<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">undefined</span></h5></li><li class="tsd-parameter"><h5>sourcemap<wbr/>Inline<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">boolean</span></h5></li></ul></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Functions</h2><section class="tsd-panel tsd-member tsd-kind-function tsd-parent-kind-module"><a id="scriptFromBlueprint" class="tsd-anchor"></a><h3>script<wbr/>From<wbr/>Blueprint</h3><ul class="tsd-signatures tsd-kind-function tsd-parent-kind-module"><li class="tsd-signature tsd-kind-icon">script<wbr/>From<wbr/>Blueprint<span class="tsd-signature-symbol">(</span>config<span class="tsd-signature-symbol">: </span><a href="blueprint.html#BlueprintConfig" class="tsd-signature-type" data-tsd-kind="Type alias">BlueprintConfig</a><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-symbol">{ </span>processedSourceMap<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">undefined</span><span class="tsd-signature-symbol">; </span>script<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Buffer</span><span class="tsd-signature-symbol"> }</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/cypress-io/v8-snapshot/blob/da2caba/src/blueprint.ts#L98">src/blueprint.ts:98</a></li></ul></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Generates the snapshot script from the templates found inside <code>./blueprint</code>
and the provided <a href="blueprint.html#BlueprintConfig">BlueprintConfig</a> and returns it a long with the
processed sourcemaps.</p>
</div><div><p>When rendering the snapshot script we take care of the following
(in order of occurrence in the rendered script):</p>
<ol>
<li><p>We embedd the path separator so that we have it available inside the
snapshot without having to refer to the <code>path</code> module</p>
</li>
<li><p>We also include helper methods like <code>cannotAccess</code> which are invoked
whenever a feature of JavaScript is accessed that would cause issues
when snapshotting.
We use this to throw an error during snapshot script verification in
order to signal to the doctor that something went wrong.
Additionally it allows us to debug any issues in a better way than
looking at a <code>mksnapshot</code> tool Segfault.</p>
</li>
<li><p>Additionally we stub out a minimal version of <code>process</code> to be used
while snapshotting</p>
</li>
<li><p>In order to catch all problems during snapshot verification we include
stricter verifiers from <code>./blueprint/globals-strict.js</code> while we are
running the doctor.
We also set <code>require.isStrict = true</code> to query it inside
./blueprint/custom-require.js in order to optimize error messages for
the specific context.
When we create the final snapshot script which will be snapshotted we
include less stricter versions of globals from ./blueprint/globals.js.</p>
</li>
</ol>
</div></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>config: <a href="blueprint.html#BlueprintConfig" class="tsd-signature-type" data-tsd-kind="Type alias">BlueprintConfig</a></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-symbol">{ </span>processedSourceMap<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">undefined</span><span class="tsd-signature-symbol">; </span>script<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Buffer</span><span class="tsd-signature-symbol"> }</span></h4><ul class="tsd-parameters"><li class="tsd-parameter"><h5>processed<wbr/>Source<wbr/>Map<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">undefined</span></h5></li><li class="tsd-parameter"><h5>script<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">Buffer</span></h5></li></ul></li></ul></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Modules</a></li><li class="current tsd-kind-module"><a href="blueprint.html">blueprint</a></li><li class=" tsd-kind-module"><a href="constants.html">constants</a></li><li class=" tsd-kind-module"><a href="create_snapshot_bundle.html">create-<wbr/>snapshot-<wbr/>bundle</a></li><li class=" tsd-kind-module"><a href="create_snapshot_script.html">create-<wbr/>snapshot-<wbr/>script</a></li><li class=" tsd-kind-module"><a href="doctor_circular_imports.html">doctor/circular-<wbr/>imports</a></li><li class=" tsd-kind-module"><a href="doctor_determine_deferred.html">doctor/determine-<wbr/>deferred</a></li><li class=" tsd-kind-module"><a href="doctor_process_script_async.html">doctor/process-<wbr/>script.async</a></li><li class=" tsd-kind-module"><a href="doctor_process_script_worker.html">doctor/process-<wbr/>script.worker</a></li><li class=" tsd-kind-module"><a href="doctor_snapshot_doctor.html">doctor/snapshot-<wbr/>doctor</a></li><li class=" tsd-kind-module"><a href="doctor_warnings_processor.html">doctor/warnings-<wbr/>processor</a></li><li class=" tsd-kind-module"><a href="loading_snapshot_require.html">loading/snapshot-<wbr/>require</a></li><li class=" tsd-kind-module"><a href="meta_dependency_map.html">meta/dependency-<wbr/>map</a></li><li class=" tsd-kind-module"><a href="snapshot_generate_entry_via_deps.html">snapshot-<wbr/>generate-<wbr/>entry-<wbr/>via-<wbr/>deps</a></li><li class=" tsd-kind-module"><a href="snapshot_generate_entry_via_yarn.html">snapshot-<wbr/>generate-<wbr/>entry-<wbr/>via-<wbr/>yarn</a></li><li class=" tsd-kind-module"><a href="snapshot_generator.html">snapshot-<wbr/>generator</a></li><li class=" tsd-kind-module"><a href="snapshot_generator_flags.html">snapshot-<wbr/>generator-<wbr/>flags</a></li><li class=" tsd-kind-module"><a href="snapshot_verifier.html">snapshot-<wbr/>verifier</a></li><li class=" tsd-kind-module"><a href="sourcemap_inline_sourcemap.html">sourcemap/inline-<wbr/>sourcemap</a></li><li class=" tsd-kind-module"><a href="sourcemap_process_sourcemap.html">sourcemap/process-<wbr/>sourcemap</a></li><li class=" tsd-kind-module"><a href="types.html">types</a></li><li class=" tsd-kind-module"><a href="utils.html">utils</a></li><li class=" tsd-kind-module"><a href="v8_snapshot.html">v8-<wbr/>snapshot</a></li><li class=" tsd-kind-module"><a href="write_config_json.html">write-<wbr/>config-<wbr/>json</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-type-alias tsd-parent-kind-module"><a href="blueprint.html#BlueprintConfig" class="tsd-kind-icon">Blueprint<wbr/>Config</a></li><li class="tsd-kind-function tsd-parent-kind-module"><a href="blueprint.html#scriptFromBlueprint" class="tsd-kind-icon">script<wbr/>From<wbr/>Blueprint</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li><li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li><li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>